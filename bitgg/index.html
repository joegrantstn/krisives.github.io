<html><head><title>Distributed Deterministic Networked Games</title><style type="text/css">ol{margin:0;padding:0}.c9{max-width:468pt;background-color:#ffffff;padding:72pt 72pt 72pt 72pt}.c4{list-style-type:disc;margin:0;padding:0}.c2{padding-left:0pt;margin-left:36pt}.c5{color:inherit;text-decoration:inherit}.c3{color:#1155cc;text-decoration:underline}.c1{height:11pt}.c6{font-style:italic}.c0{direction:ltr}.c8{font-weight:bold}.c7{text-align:center}.title{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:36pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}.subtitle{padding-top:18pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:24pt;font-family:"Georgia";padding-bottom:4pt}li{color:#000000;font-size:11pt;font-family:"Arial"}p{color:#000000;font-size:11pt;margin:0;font-family:"Arial"}h1{padding-top:24pt;line-height:1.15;text-align:left;color:#000000;font-size:18pt;font-family:"Arial";font-weight:bold;padding-bottom:6pt}h2{padding-top:18pt;line-height:1.15;text-align:left;color:#000000;font-size:14pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h3{padding-top:14pt;line-height:1.15;text-align:left;color:#666666;font-size:12pt;font-family:"Arial";font-weight:bold;padding-bottom:4pt}h4{padding-top:12pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:11pt;font-family:"Arial";padding-bottom:2pt}h5{padding-top:11pt;line-height:1.15;text-align:left;color:#666666;font-size:10pt;font-family:"Arial";font-weight:bold;padding-bottom:2pt}h6{padding-top:10pt;line-height:1.15;text-align:left;color:#666666;font-style:italic;font-size:10pt;font-family:"Arial";padding-bottom:2pt}</style></head><body class="c9"><h1 class="c0 c7"><a name="h.pfrpop3o6uq0"></a><span>Distributed Deterministic Networked Games</span></h1><p class="c0 c7"><span>by </span><span class="c3"><a class="c5" href="mailto:kristopher.ives@gmail.com">Kristopher Ives</a></span></p><h3 class="c0"><a name="h.lzmfp9571s1"></a><span>Preface</span></h3><p class="c0"><span>Thanks for taking the time to read my draft document on fully distributed games. If you have any comments or questions please contact </span><span class="c3"><a class="c5" href="mailto:kristopher.ives@gmail.com">kristopher.ives@gmail.com</a></span><span>&nbsp;- I am open to sharing code but want to avoid creating a blast of interest among game implementors seeing an unfinished framework and worse yet folks creating insecure games. This is an </span><span class="c8">extremely experimental idea</span><span>&nbsp;that aims to create a fully open and distributed gaming platform.</span></p><p class="c1 c0"><span></span></p><h3 class="c0"><a name="h.43yqa13m2l5c"></a><span>Context</span></h3><p class="c0"><span>Currently multiplayer games are mostly client-server based with some peer-to-peer games, typically where &nbsp;a single peer has more say than the others. All peer-to-peer games are instance based, where your progress doesn&rsquo;t translate across multiple gaming sessions without the help of a master server. Currently all persistent online multi-player games use the client-server model. The advantage is that a single entity like a game company can control how the system works and pay the cost of maintaining the secured servers.</span></p><p class="c1 c0"><span></span></p><p class="c0 c7"><img height="177" src="images/image02.png" width="338"></p><p class="c0 c7"><span class="c6">An elephant in the room</span></p><p class="c1 c0"><span></span></p><p class="c0"><span>Similarly content distribution networks in the gaming field are centralized. While the Steam network does a good job of pleasing their player base and providing fast content delivery using a peer-to-peer like system, players are ultimately subject to their single point of failure when it does occur.</span></p><p class="c1 c0"><span></span></p><p class="c0"><span>The drawbacks of a traditional client-server model are mainly scalability and freedom, as with any trade-off between centralization and decentralization. As a consumer of great client-server modelled games I am not on a crusade to destroy traditional technologies, but rather want to see both technologies emerge alongside one another.</span></p><h3 class="c0"><a name="h.hvp2xsum31hr"></a><span>Introduction</span></h3><p class="c0"><span>The ideas presented in this article create a network of peers which publish events into a </span><span class="c6">block-chain</span><span>&nbsp;that stores the game history.</span></p><p class="c1 c0"><span></span></p><p class="c0 c7"><img height="234" src="images/image01.png" width="434"></p><p class="c0 c7"><span class="c6">A distributed replacement for the client-server model</span></p><p class="c1 c0"><span></span></p><p class="c0"><span>All games that run on the network must be fully deterministic, because all peers must agree on the state of the game via the order of events in the block chain. In simple terms any event in the game must operate on a game state and always modify that state with the same predictable results. This limitation frees each game from implementing any network specific code and greatly simplifies the understanding of games between peers.</span></p><p class="c1 c0"><span></span></p><p class="c0"><span>Some ideas have been considered for creating a secure distributed source of entropy, possibly based on the block chain hashes. This would prevent cheating in many games and make simple games like Poker and Blackjack where the outcome of a single action or hidden information is the entire game.</span></p><p class="c1 c0"><span></span></p><h3 class="c0"><a name="h.w5oobdu4zij6"></a><span>Accounts and Peers</span></h3><p class="c0"><span>All messages in the network are sent via a </span><span class="c6">Peer</span><span>. Each peer in the network represents an </span><span class="c6">Account</span><span>&nbsp;that joined the game at a specific time. Each Account has the following structure and information:</span></p><ol class="c4" start="1"><li class="c0 c2"><span>A (1024-bit) RSA public key they expose so other peers can verify messages are authorized by a game account</span></li><li class="c2 c0"><span>An RSA private key they do not expose, which is used to sign messages into the network</span></li><li class="c2 c0"><span>A 160-bit hash of the block when this account was created</span></li><li class="c2 c0"><span>A 160-bit signature </span><span>of a portion of the game history up until the block</span></li><li class="c2 c0"><span>A globally unique 64-bit identifier created by hashing the 160-bit signature. If the ID would be zero or already exists the peer must try again</span></li></ol><p class="c0 c1"><span></span></p><p class="c0"><span>Account data is only known by the account holders and includes an RSA private key. Currently all private account data is stored computer running the game, but an idea of AES encryption into the block store could allow for entirely persistent accounts that can be logged into anywhere.</span></p><p class="c1 c0"><span></span></p><h3 class="c0"><a name="h.hwcgq095cr8e"></a><span>Block Chain</span></h3><p class="c0"><span>All data in the game is stored in a distributed cryptographic data structure called the </span><span class="c6">Block Chain</span><span>. It consists of all the events published to the network by peers. As peers play the game they simulate the game logic via a queue of events that modify the game state. Game time is divided into blocks as part of the block chain. All of the events that occurred during that time period are put into this block and published to the network so everyone can agree on what order everything happened.</span></p><p class="c1 c0"><span></span></p><p class="c0 c7"><img height="211" src="images/image00.png" width="490"></p><h3 class="c0"><a name="h.f18nousjeh8s"></a><span>Creating an Account</span></h3><p class="c0"><span>Anyone who wants to talk on the network must generate a private-public key pair and sign the game history up to some point with their private key creating a proof-of-work and implicit agreement that the client knows the game logic and history. This allows games to enforce their own account creation difficulty rating. The tradeoff is most people don&rsquo;t want to spend a long time waiting to generate an account.</span></p><p class="c1 c0"><span></span></p><h3 class="c0"><a name="h.lxoxswkmqx8a"></a><span>Logging into the Network</span></h3><p class="c0"><span>An account broadcasts a login message containing a signature of a very recently block in the game block chain. This message gets verified and forms an immutable history of the player entering the game with that account during that time. The player continues to sign recent blocks into the block-chain as &ldquo;keep-alive&rdquo; messages. This forces all players to validate the game state for others to stay accepted in the network, because without keep-alive messages they will be ignored by the network.</span></p><p class="c1 c0"><span></span></p><h3 class="c0"><a name="h.oesvb26mhnnh"></a><span>Getting the Game State</span></h3><p class="c0"><span>The game history is distributed among peers of the network. In theory a peer can work from the genesis block, but as time goes on this gets expensive and is not scalable. Instead peers download a snapshot of the game state that occurred somewhat recently and resume the game from that point. Storing snapshots of the world at a certain point also allows for switchovers to occur when the game logic has been changed by a patch.</span></p><p class="c1 c0"><span></span></p><h3 class="c0"><a name="h.gcbz1ye5zlbb"></a><span>Publishing Events</span></h3><p class="c0"><span>TODO - How events are published to the block-chain</span></p><h3 class="c0"><a name="h.nnlawq3wlndj"></a><span>How are Forks Handled</span></h3><p class="c0"><span>When peers on the network disagree on how the game state played out they do so by publishing blocks extending the same block hash to different ones, creating a </span><span class="c6">fork</span><span>&nbsp;in the block chain. Peers will select the block chain that has the most unique players.</span></p><h3 class="c0"><a name="h.tu1ighxxcuq5"></a><span>Locality</span></h3><p class="c0"><span>Eventually games will need to be structured in a way that comprises of many block-chains for different areas and types of events. Currently for simplicity a single block-chain is being worked on with the understanding many can be used later.</span></p><h3 class="c0"><a name="h.g4kja4hekqwh"></a><span>Visibility</span></h3><p class="c0"><span>One limitation (shared with Bitcoin) is that all players must agree on all events of the game. This can be mitigated by splitting block chains apart, etc. the abstract problem still remains that any players exposed to events of others must get all data and information about those events. For example, consider a player that has a backpack with secret contents that logs in or enters the area of another player. All players are revealing their hand and hoping other players don&rsquo;t look, possibly relying on some code that censors the cards so to speak. It&rsquo;s a poor security model and the result is the contents of the bag has to be assumed to be known. This creates a visibility problem of events and objects at odds with the game state needing to be verified.</span></p><p class="c1 c0"><span></span></p></body></html>